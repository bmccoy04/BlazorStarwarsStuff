@page "/TodoV2"
@using StarwarsStuff.Ui.Models

<h3>TodoV2</h3>

<h3>Todo (@todos.Count(todo => !todo.IsDone))</h3>

<ul>
   @foreach (var todo in todos.Where(x => !x.IsDone))
   {
      <li>
         @todo.Title <DeleteButton OnClick="@(() => MarkDone(todo.Title))" Title="Done" />
      </li>
   }
</ul>

<input placeholder accept="Someting Todo" @bind="newTodo" />
<SubmitButton OnClick="@AddTodo" Title="Submit"/>

@code {
   private IList<TodoItem> todos = new List<TodoItem>();

   private string newTodo;

   private void AddTodo()
   {
      if (!string.IsNullOrWhiteSpace(newTodo))
      {
         todos.Add(new TodoItem() { Title = newTodo });
         newTodo = string.Empty;
      }
   }

   private void MarkDone(string title)
   {
      var todo = todos.FirstOrDefault(x => x.Title == title && !x.IsDone);

      if(todo != null)
         todo.IsDone = true;
   }
}
